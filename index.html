<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lowveld Padel Pro - Season 2</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="css/styles.css" rel="stylesheet">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#1a1a1a">
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">
</head>
<body class="bg-gray-900 text-white">
  <!-- Navigation -->
  <nav class="bg-black/90 backdrop-blur-sm fixed w-full z-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between h-16">
        <a href="index.html" class="flex items-center">
          <h1 class="text-2xl font-bold bg-gradient-to-r from-blue-400 to-purple-500 bg-clip-text text-transparent">
            üèì Padel Pro
          </h1>
        </a>
        <div class="hidden md:flex items-center space-x-8">
          <a href="#franchises" class="hover:text-blue-400 transition-colors">Franchises</a>
          <a href="#fantasy" class="hover:text-blue-400 transition-colors">Fantasy</a>
          <a href="#marketplace" class="hover:text-blue-400 transition-colors">Marketplace</a>
          <a href="#live-stream" class="hover:text-blue-400 transition-colors">Live Stream</a>
          <a href="#schedule" class="hover:text-blue-400 transition-colors">Schedule</a>
          <a href="#" id="navGetStarted" class="bg-gradient-to-r from-blue-500 to-purple-600 px-6 py-2 rounded-lg hover:from-blue-600 hover:to-purple-700 transition-all">Sign In / Register</a>
        </div>
        <div class="md:hidden flex items-center">
          <button onclick="toggleMobileMenu()" class="text-white" aria-label="Open menu">
            <i class="fas fa-bars text-xl"></i>
          </button>
        </div>
      </div>
    </div>
    <div id="mobileMenu" class="hidden md:hidden bg-black/95 backdrop-blur-sm">
      <div class="px-2 pt-2 pb-3 space-y-1">
        <a href="#franchises" class="block px-3 py-2 hover:bg-gray-800 rounded">Franchises</a>
        <a href="#fantasy" class="block px-3 py-2 hover:bg-gray-800 rounded">Fantasy</a>
        <a href="#marketplace" class="block px-3 py-2 hover:bg-gray-800 rounded">Marketplace</a>
        <a href="#live-stream" class="block px-3 py-2 hover:bg-gray-800 rounded">Live Stream</a>
        <a href="#schedule" class="block px-3 py-2 hover:bg-gray-800 rounded">Schedule</a>
        <a href="#" id="mobileGetStarted" class="block w-full px-3 py-2 bg-gradient-to-r from-blue-500 to-purple-600 rounded">Sign In / Register</a>
      </div>
    </div>
  </nav>
  <div class="h-16"></div>

  <!-- Platform Features (Home) -->
  <section id="home" class="py-20 bg-gradient-to-br from-gray-900 to-black">
    <div class="max-w-7xl mx-auto px-4">
      <div class="text-center mb-16">
        <h2 class="text-4xl md:text-5xl font-bold mb-4 bg-gradient-to-r from-blue-400 to-purple-500 bg-clip-text text-transparent">Platform Features</h2>
        <p class="text-xl text-gray-400">Everything you need for the ultimate padel experience</p>
      </div>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
        <div class="feature-card bg-gradient-to-br from-purple-900/30 to-pink-900/30 rounded-xl p-6 hover:scale-105 transition-all">
          <div class="text-center">
            <div class="w-16 h-16 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center mx-auto mb-4">
              <i class="fas fa-trophy text-2xl text-white"></i>
            </div>
            <h3 class="text-xl font-bold text-purple-400 mb-2">Fantasy League</h3>
            <p class="text-gray-400 text-sm">Build your dream team with R100k salary cap</p>
          </div>
        </div>
        <div class="feature-card bg-gradient-to-br from-blue-900/30 to-cyan-900/30 rounded-xl p-6 hover:scale-105 transition-all">
          <div class="text-center">
            <div class="w-16 h-16 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-full flex items-center justify-center mx-auto mb-4">
              <i class="fas fa-gavel text-2xl text-white"></i>
            </div>
            <h3 class="text-xl font-bold text-blue-400 mb-2">Live Stream</h3>
            <p class="text-gray-400 text-sm">Watch Players in action real-time!</p>
          </div>
        </div>
        <div class="feature-card bg-gradient-to-br from-green-900/30 to-emerald-900/30 rounded-xl p-6 hover:scale-105 transition-all">
          <div class="text-center">
            <div class="w-16 h-16 bg-gradient-to-r from-green-500 to-emerald-500 rounded-full flex items-center justify-center mx-auto mb-4">
              <i class="fas fa-store text-2xl text-white"></i>
            </div>
            <h3 class="text-xl font-bold text-green-400 mb-2">Marketplace</h3>
            <p class="text-gray-400 text-sm">Buy equipment, coaching, and more</p>
          </div>
        </div>
        <div class="feature-card bg-gradient-to-br from-orange-900/30 to-red-900/30 rounded-xl p-6 hover:scale-105 transition-all">
          <div class="text-center">
            <div class="w-16 h-16 bg-gradient-to-r from-orange-500 to-red-500 rounded-full flex items-center justify-center mx-auto mb-4">
              <i class="fas fa-users text-2xl text-white"></i>
            </div>
            <h3 class="text-xl font-bold text-orange-400 mb-2">League Management</h3>
            <p class="text-gray-400 text-sm">Complete tournament and league control</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Schedule Section -->
  <section id="schedule" class="hidden py-20 bg-gradient-to-br from-gray-900 to-black">
    <div class="max-w-7xl mx-auto px-4">
      <h2 class="text-4xl md:text-5xl font-bold mb-4 bg-gradient-to-r from-blue-400 to-purple-500 bg-clip-text text-transparent">Schedule</h2>
      <div class="filters flex flex-wrap gap-4 mb-6">
        <select id="filter-tier" class="px-4 py-2 rounded bg-white/5 border border-white/10 text-white">
          <option value="all">All Tiers</option>
          <option value="Premier">Premier</option>
          <option value="Championship">Championship</option>
        </select>
        <select id="filter-status" class="px-4 py-2 rounded bg-white/5 border border-white/10 text-white">
          <option value="all">All Statuses</option>
          <option value="Scheduled">Scheduled</option>
          <option value="Today">Today</option>
          <option value="Live">Live</option>
          <option value="Completed">Completed</option>
        </select>
        <select id="filter-venue" class="px-4 py-2 rounded bg-white/5 border border-white/10 text-white">
          <option value="all">All Venues</option>
          <option value="Play360">Play360</option>
          <option value="Padel24">Padel24</option>
        </select>
        <button id="export-csv" class="px-4 py-2 rounded bg-blue-500/80 hover:bg-blue-500">Export CSV</button>
      </div>
      <div class="overflow-x-auto">
        <table id="schedule-table" class="w-full text-left border-collapse">
          <thead>
            <tr class="bg-white/5">
              <th class="p-4">Round</th>
              <th class="p-4">Match</th>
              <th class="p-4">Tier</th>
              <th class="p-4">Venue</th>
              <th class="p-4">Date</th>
              <th class="p-4">Fixture</th>
              <th class="p-4">Status</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </section>

  <!-- Franchises Section -->
  <section id="franchises" class="scroll-mt-24 py-20 bg-gradient-to-br from-gray-900 to-black">
    <div class="max-w-7xl mx-auto px-4">
      <div class="text-center mb-12">
        <h2 class="text-4xl md:text-5xl font-extrabold mb-3 tracking-tight bg-gradient-to-r from-blue-300 to-purple-300 bg-clip-text text-transparent">
          Lowveld Padel Franchises
        </h2>
        <p class="text-sm md:text-base tracking-widest text-indigo-200/80">
          MEET THE 8 POWERHOUSE FRANCHISES COMPETING FOR GLORY!!!
        </p>
      </div>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
        <a href="franchise.html?team=desert-falcons" class="franchise-card bg-gradient-to-br from-orange-900/50 to-yellow-900/50 rounded-xl p-6 hover:scale-105 transition-all cursor-pointer" aria-label="Open Desert Falcons franchise">
          <div class="text-center">
            <video class="w-28 h-28 mx-auto mb-4 rounded-full object-cover ring-2 ring-white/20" poster="assets/logos/desert-falcons.jpeg" autoplay muted loop playsinline preload="metadata" title="Desert Falcons logo animation">
              <source src="assets/logos/desert-falcons.mp4" type="video/mp4" />
              <img src="assets/logos/desert-falcons.jpeg" alt="Desert Falcons" />
            </video>
            <h3 class="text-2xl font-extrabold text-orange-300 mb-2">Desert Falcons</h3>
            <p class="text-indigo-100/80 text-sm mb-6">Soaring to victory with precision and power</p>
          </div>
        </a>
        <a href="franchise.html?team=globo-boomerangs" class="franchise-card bg-gradient-to-br from-blue-900/50 to-red-900/50 rounded-xl p-6 hover:scale-105 transition-all cursor-pointer" aria-label="Open Globo Boomerangs franchise">
          <div class="text-center">
            <video class="w-28 h-28 mx-auto mb-4 rounded-full object-cover ring-2 ring-white/20" poster="assets/logos/globo-boomerangs.jpeg" autoplay muted loop playsinline preload="metadata" title="Globo Boomerangs logo animation">
              <source src="assets/logos/globo-boomerangs.mp4" type="video/mp4" />
              <img src="assets/logos/globo-boomerangs.jpeg" alt="Globo Boomerangs" />
            </video>
            <h3 class="text-2xl font-extrabold text-blue-300 mb-2">Globo Boomerangs</h3>
            <p class="text-indigo-100/80 text-sm mb-6">What goes around, comes around stronger</p>
          </div>
        </a>
        <a href="franchise.html?team=ice-breakers" class="franchise-card bg-gradient-to-br from-cyan-900/50 to-blue-900/50 rounded-xl p-6 hover:scale-105 transition-all cursor-pointer" aria-label="Open Ice Breakers franchise">
          <div class="text-center">
            <video class="w-28 h-28 mx-auto mb-4 rounded-full object-cover ring-2 ring-white/20" poster="assets/logos/ice-breakers.jpeg" autoplay muted loop playsinline preload="metadata" title="Ice Breakers logo animation">
              <source src="assets/logos/ice-breakers.mp4" type="video/mp4" />
              <img src="assets/logos/ice-breakers.jpeg" alt="Ice Breakers" />
            </video>
            <h3 class="text-2xl font-extrabold text-cyan-300 mb-2">Ice Breakers</h3>
            <p class="text-indigo-100/80 text-sm mb-6">Breaking through with cool precision</p>
          </div>
        </a>
        <a href="franchise.html?team=baltic-blades" class="franchise-card bg-gradient-to-br from-blue-900/50 to-purple-900/50 rounded-xl p-6 hover:scale-105 transition-all cursor-pointer" aria-label="Open Baltic Blades franchise">
          <div class="text-center">
            <video class="w-28 h-28 mx-auto mb-4 rounded-full object-cover ring-2 ring-white/20" poster="assets/logos/baltic-blades.jpeg" autoplay muted loop playsinline preload="metadata" title="Baltic Blades logo animation">
              <source src="assets/logos/baltic-blades.mp4" type="video/mp4" />
              <img src="assets/logos/baltic-blades.jpeg" alt="Baltic Blades" />
            </video>
            <h3 class="text-2xl font-extrabold text-blue-300 mb-2">Baltic Blades</h3>
            <p class="text-indigo-100/80 text-sm mb-6">Sharp, swift, and unstoppable</p>
          </div>
        </a>
        <a href="franchise.html?team=avalanche-aces" class="franchise-card bg-gradient-to-br from-blue-900/50 to-orange-900/50 rounded-xl p-6 hover:scale-105 transition-all cursor-pointer" aria-label="Open Avalanche Aces franchise">
          <div class="text-center">
            <video class="w-28 h-28 mx-auto mb-4 rounded-full object-cover ring-2 ring-white/20" poster="assets/logos/avalanche-aces.jpeg" autoplay muted loop playsinline preload="metadata" title="Avalanche Aces logo animation">
              <source src="assets/logos/avalanche-aces.mp4" type="video/mp4" />
              <img src="assets/logos/avalanche-aces.jpeg" alt="Avalanche Aces" />
            </video>
            <h3 class="text-2xl font-extrabold text-blue-300 mb-2">Avalanche Aces</h3>
            <p class="text-indigo-100/80 text-sm mb-6">Unstoppable force of nature</p>
          </div>
        </a>
        <a href="franchise.html?team=rulo-apaches" class="franchise-card bg-gradient-to-br from-red-900/50 to-orange-900/50 rounded-xl p-6 hover:scale-105 transition-all cursor-pointer" aria-label="Open Rulo Apaches franchise">
          <div class="text-center">
            <video class="w-28 h-28 mx-auto mb-4 rounded-full object-cover ring-2 ring-white/20" poster="assets/logos/rulo-apaches.jpeg" autoplay muted loop playsinline preload="metadata" title="Rulo Apaches logo animation">
              <source src="assets/logos/rulo-apaches.mp4" type="video/mp4" />
              <img src="assets/logos/rulo-apaches.jpeg" alt="Rulo Apaches" />
            </video>
            <h3 class="text-2xl font-extrabold text-red-300 mb-2">Rulo Apaches</h3>
            <p class="text-indigo-100/80 text-sm mb-6">Warriors of the court</p>
          </div>
        </a>
        <a href="franchise.html?team=samurai-kicksmashers" class="franchise-card bg-gradient-to-br from-orange-900/50 to-blue-900/50 rounded-xl p-6 hover:scale-105 transition-all cursor-pointer" aria-label="Open Samurai Kicksmashers franchise">
          <div class="text-center">
            <video class="w-28 h-28 mx-auto mb-4 rounded-full object-cover ring-2 ring-white/20" poster="assets/logos/samurai-kicksmashers.jpeg" autoplay muted loop playsinline preload="metadata" title="Samurai Kicksmashers logo animation">
              <source src="assets/logos/samurai-kicksmashers.mp4" type="video/mp4" />
              <img src="assets/logos/samurai-kicksmashers.jpeg" alt="Samurai Kicksmashers" />
            </video>
            <h3 class="text-2xl font-extrabold text-orange-300 mb-2">Samurai Kicksmashers</h3>
            <p class="text-indigo-100/80 text-sm mb-6">Honor, discipline, victory</p>
          </div>
        </a>
        <a href="franchise.html?team=sonic-viboras" class="franchise-card bg-gradient-to-br from-purple-900/50 to-pink-900/50 rounded-xl p-6 hover:scale-105 transition-all cursor-pointer" aria-label="Open Sonic Viboras franchise">
          <div class="text-center">
            <video class="w-28 h-28 mx-auto mb-4 rounded-full object-cover ring-2 ring-white/20" poster="assets/logos/sonic-viboras.jpeg" autoplay muted loop playsinline preload="metadata" title="Sonic Viboras logo animation">
              <source src="assets/logos/sonic-viboras.mp4" type="video/mp4" />
              <img src="assets/logos/sonic-viboras.jpeg" alt="Sonic Viboras" />
            </video>
            <h3 class="text-2xl font-extrabold text-purple-300 mb-2">Sonic Viboras</h3>
            <p class="text-indigo-100/80 text-sm mb-6">Lightning fast, deadly accurate</p>
          </div>
        </a>
      </div>
    </div>
  </section>

  <!-- Fantasy Section -->
  <section id="fantasy" class="hidden py-20 bg-gradient-to-br from-gray-900 to-black">
    <div class="max-w-7xl mx-auto px-4">
      <h2 class="text-4xl md:text-5xl font-bold mb-4 bg-gradient-to-r from-blue-400 to-purple-500 bg-clip-text text-transparent">Fantasy League</h2>
      <p class="text-xl text-gray-400 mb-8">Build your dream team with R100k salary cap</p>
      <div class="bg-white/5 p-6 rounded-xl">
        <h3 class="text-2xl font-bold mb-4">Your Squad</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4" id="fantasy-squad"></div>
        <div class="mt-6 flex justify-between items-center">
          <p class="text-lg" id="fantasy-cost">Total Cost: R0 / R100,000</p>
          <button class="py-2 px-6 rounded bg-blue-500/80 hover:bg-blue-500" id="save-squad">Save Squad</button>
        </div>
      </div>
    </div>
  </section>

  <!-- Marketplace Section -->
  <section id="marketplace" class="hidden py-20 bg-gradient-to-br from-gray-900 to-black">
    <div class="max-w-7xl mx-auto px-4">
      <h2 class="text-4xl md:text-5xl font-bold mb-4 bg-gradient-to-r from-blue-400 to-purple-500 bg-clip-text text-transparent">Marketplace</h2>
      <p class="text-xl text-gray-400 mb-8">Buy equipment, coaching, and more</p>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-8" id="marketplace-listings"></div>
      <button class="mt-8 py-2 px-6 rounded bg-green-500/80 hover:bg-green-500" id="add-listing">Add Listing</button>
    </div>
  </section>

  <!-- Live Stream Section -->
  <section id="live-stream" class="hidden py-20 bg-gradient-to-br from-gray-900 to-black">
    <div class="max-w-7xl mx-auto px-4">
      <h2 class="text-4xl md:text-5xl font-bold mb-4 bg-gradient-to-r from-blue-400 to-purple-500 bg-clip-text text-transparent">Live Stream</h2>
      <p class="text-xl text-gray-400 mb-8">Watch ongoing matches live</p>
      <div class="bg-white/5 p-6 rounded-xl">
        <iframe class="w-full h-96" src="https://www.youtube.com/embed/dQw4w9WgXcQ" title="Live Stream Placeholder" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
      </div>
    </div>
  </section>

  <!-- CTA Section -->
  <section class="py-20 bg-gradient-to-r from-blue-600 to-purple-700">
    <div class="max-w-4xl mx-auto text-center px-4">
      <h2 class="text-4xl md:text-5xl font-bold mb-6 text-white">Ready to Dominate?</h2>
      <p class="text-xl mb-8 text-blue-100">Join Padel Pro and experience the future of padel competition</p>
      <div class="flex flex-col sm:flex-row gap-4 justify-center">
        <a href="#" id="ctaJoinNow" class="bg-white text-blue-600 px-8 py-4 rounded-lg text-lg font-semibold hover:bg-gray-100 transition-all transform hover:scale-105">Sign In / Register</a>
        <a href="dashboard.html" id="ctaAdmin" class="hidden"></a>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="bg-black py-12">
    <div class="max-w-7xl mx-auto px-4 text-center text-gray-400">¬© <span id="year"></span> Nomz. All rights reserved.</div>
  </footer>

  <!-- Auth Modal -->
  <div id="authOverlay" class="fixed inset-0 bg-black/70 backdrop-blur-sm hidden items-center justify-center z-[100]">
    <div class="w-full max-w-md mx-4">
      <div class="relative bg-gradient-to-b from-white/10 to-white/5 border border-white/10 rounded-2xl shadow-2xl p-6">
        <button id="authClose" class="absolute top-3 right-3 text-white/70 hover:text-white" aria-label="Close">‚úï</button>
        <div id="authSignIn">
          <h2 class="text-xl font-semibold mb-4">Sign In</h2>
          <form id="signin_modal" class="space-y-4">
            <div>
              <label class="block text-sm mb-1">Email</label>
              <input id="email" type="email" class="w-full px-3 py-2 rounded bg-white/5 border border-white/10" required />
            </div>
            <div>
              <label class="block text-sm mb-1">Password</label>
              <input id="password" type="password" class="w-full px-3 py-2 rounded bg-white/5 border border-white/10" required />
            </div>
            <p id="error" class="text-rose-300 text-sm min-h-[1.25rem]"></p>
            <button class="w-full py-2 rounded bg-blue-500/80 hover:bg-blue-500">Sign In</button>
          </form>
          <button id="getTempModal" class="mt-3 text-sm underline underline-offset-2 hover:no-underline opacity-90">Forgot password? Get a temporary password</button>
          <p id="tempMsgModal" class="text-emerald-300 text-sm min-h-[1.25rem] mt-1"></p>
          <div class="mt-4 text-sm text-center opacity-90">
            Not registered? <button id="goRegister" class="underline hover:no-underline text-blue-300">Register Now</button>
          </div>
          <p class="text-xs opacity-75 mt-3">Tip: use your <b>temporary password</b> the first time ‚Äî you'll be asked to reset it.</p>
        </div>
        <div id="authRegister" class="hidden">
          <h2 class="text-xl font-semibold mb-4">Create Account</h2>
          <form id="register_modal" class="space-y-4">
            <div>
              <label class="block text-sm mb-1">Full Name</label>
              <input id="r_name" type="text" class="w-full px-3 py-2 rounded bg-white/5 border border-white/10" required />
            </div>
            <div>
              <label class="block text-sm mb-1">Email</label>
              <input id="r_email" type="email" class="w-full px-3 py-2 rounded bg-white/5 border border-white/10" required />
            </div>
            <button class="w-full py-2 rounded bg-emerald-500/80 hover:bg-emerald-500">Create Account</button>
            <p id="r_msg_modal" class="text-sm mt-2 min-h-[1.25rem]"></p>
          </form>
          <div class="mt-4 text-sm text-center opacity-90">
            Already have an account? <button id="goSignIn" class="underline hover:no-underline text-blue-300">Sign In</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Player Quick-View Modal -->
  <div id="playerQuickModal" class="fixed inset-0 bg-black/70 hidden items-center justify-center z-[100] p-4">
    <div class="bg-[#0f1220] border border-white/10 rounded-2xl w-full max-w-md overflow-hidden relative">
      <div class="p-4">
        <div class="rounded-2xl overflow-hidden w-full aspect-[4/5] bg-black/20 relative">
          <img id="pqmImg" src="" alt="" class="w-full h-full object-cover">
          <div id="pqmInitials" class="hidden absolute inset-0 flex items-center justify-center text-4xl font-bold text-white/80">--</div>
        </div>
        <div class="mt-4">
          <div id="pqmName" class="text-xl font-bold"></div>
          <div id="pqmMeta" class="text-sm text-gray-400"></div>
        </div>
      </div>
      <button id="pqmClose" class="absolute top-3 right-3 text-white/70 hover:text-white" aria-label="Close">‚úï</button>
    </div>
  </div>

  <script type="module" src="js/app.js"></script>
  <!-- Firebase: Auth + Firestore -->
<script type="module">
  // 1) Import Firebase (use the version shown in your Firebase console snippet if different)
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-app.js";
  import {
    getAuth, onAuthStateChanged,
    signInWithEmailAndPassword, createUserWithEmailAndPassword,
    sendPasswordResetEmail, updateProfile, signOut
  } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-auth.js";
  import {
    getFirestore, doc, setDoc, getDoc, serverTimestamp
  } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-firestore.js";

  // 2) Your Firebase config (copy from Firebase console ‚Üí Web app setup)
  const firebaseConfig = {
    apiKey: "PASTE_HERE",
    authDomain: "PASTE_HERE",
    projectId: "PASTE_HERE",
    storageBucket: "PASTE_HERE",
    messagingSenderId: "PASTE_HERE",
    appId: "PASTE_HERE"
  };

  // 3) Init
  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db   = getFirestore(app);

  // ---- UI elements you already have ----
  const overlay = document.getElementById('authOverlay');
  const signInForm = document.getElementById('signin_modal');
  const registerForm = document.getElementById('register_modal');
  const errorBox = document.getElementById('error');
  const getTempBtn = document.getElementById('getTempModal');
  const tempMsg = document.getElementById('tempMsgModal');
  const rMsg = document.getElementById('r_msg_modal');
  const navGetStarted = document.getElementById('navGetStarted');
  const mobileGetStarted = document.getElementById('mobileGetStarted');
  const ctaJoinNow = document.getElementById('ctaJoinNow');
  const ctaAdmin = document.getElementById('ctaAdmin');

  // ---- Auth state ‚Üí toggle UI ----
  onAuthStateChanged(auth, async (user) => {
    if (user) {
      // Ensure a user profile doc exists
      const uref = doc(db, 'users', user.uid);
      const snap = await getDoc(uref);
      if (!snap.exists()) {
        await setDoc(uref, {
          uid: user.uid,
          name: user.displayName || '',
          email: user.email || '',
          role: 'player',
          createdAt: serverTimestamp()
        });
      }

      // Hide "Sign In / Register" buttons; show Dashboard link
      navGetStarted?.classList.add('hidden');
      mobileGetStarted?.classList.add('hidden');
      ctaJoinNow?.classList.add('hidden');
      ctaAdmin?.classList.remove('hidden');
    } else {
      // Logged out
      navGetStarted?.classList.remove('hidden');
      mobileGetStarted?.classList.remove('hidden');
      ctaJoinNow?.classList.remove('hidden');
      ctaAdmin?.classList.add('hidden');
    }
  });

  // ---- Sign in ----
  signInForm?.addEventListener('submit', async (e) => {
    e.preventDefault();
    errorBox.textContent = '';
    const email = document.getElementById('email').value.trim();
    const password = document.getElementById('password').value;
    try {
      await signInWithEmailAndPassword(auth, email, password);
      overlay.classList.add('hidden');
    } catch (err) {
      errorBox.textContent = (err.message || String(err)).replace('Firebase: ', '');
    }
  });

  // ---- Register (create account with a temp password, then email reset link) ----
  registerForm?.addEventListener('submit', async (e) => {
    e.preventDefault();
    rMsg.textContent = '';
    const name  = document.getElementById('r_name').value.trim();
    const email = document.getElementById('r_email').value.trim();

    // Generate a random temporary password
    const tempPw = Math.random().toString(36).slice(-10) + "Aa1!";
    try {
      const cred = await createUserWithEmailAndPassword(auth, email, tempPw);
      await updateProfile(cred.user, { displayName: name });
      await setDoc(doc(db, 'users', cred.user.uid), {
        uid: cred.user.uid, name, email, role: 'player', createdAt: serverTimestamp()
      });
      await sendPasswordResetEmail(auth, email);
      rMsg.textContent = "Account created. Check your email to set your password.";
    } catch (err) {
      rMsg.textContent = (err.message || String(err)).replace('Firebase: ', '');
    }
  });

  // ---- ‚ÄúForgot password? Get a temporary password‚Äù ‚Üí send reset email ----
  getTempBtn?.addEventListener('click', async () => {
    tempMsg.textContent = '';
    const email = document.getElementById('email').value.trim();
    if (!email) {
      tempMsg.textContent = "Enter your email above first.";
      return;
    }
    try {
      await sendPasswordResetEmail(auth, email);
      tempMsg.textContent = "Reset link sent. Check your inbox.";
    } catch (err) {
      tempMsg.textContent = (err.message || String(err)).replace('Firebase: ', '');
    }
  });

  // Optional: expose a quick sign-out in the console
  window.padelSignOut = () => signOut(auth);
</script>

</body>
</html>
